---
import { SignupForm, type SignupFormData } from "@krag/react-ui"

import Layout from '../layouts/AuthLayout.astro';
---

<Layout title="Sign Up">
  <SignupForm
    client:load
    onSubmit={async (data: SignupFormData["formData"]) => {
      const response = await fetch("/api/auth/sign-up", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(data),
      })
      
      if (!response.ok) {
        const error = await response.json()
        throw new Error(error.message || "Failed to create account")
      }
      
      Astro.redirect("/dashboard");
    }}
  />
</Layout>
